<div class="row">
  <h1 class="mr-2">後台設定服務網</h1>
  <hr>
  <div class="align-self-center mx-5">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#newModal">
    新增服務網
    </button>
  </div>
  <div class="align-self-center mx-5">
    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#searchModal">
    搜尋
    </button>
  </div>
  <div class="align-self-center mx-5">
    <%= link_to  "清除搜尋", admin_root_path, class: "btn btn-outline-primary" %>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th><%= sort_link(@ransack, :tag, "註記", default_order: :asc) %></th>
        <th><%= sort_link(@ransack, :no, "代號", default_order: :asc) %></th>
        <th>名稱</th>
        <th>經度</th>
        <th>緯度</th>
        <th>#</th>
      </tr>
    </thead>
    <tbody>
      <% @services.each do |service| %>
        <tr id=<%= service.id %>>
          <td><%= service.tag %></td>
          <td><%= service.no %></td>
          <td><%= service.name %></td>
          <td><%= service.lng %></td>
          <td><%= service.lat %></td>
          <td>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target=<%= "#Modal-#{service.id}" %>>Edit</button>
            <%= link_to "delete", admin_service_path(service), method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-primary" %>
          </td>
        </tr>
        <div class="modal fade" id=<%= "Modal-#{service.id}" %> tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">修改服務網</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <%= form_tag admin_service_path(service), method: :patch, class: "form" do %>
                  <div class="form-group">
                    <%= label_tag :tag, "註記" %>
                    <%= select_tag :tag, options_for_select(['優','無','劣'], service.tag), class: "form-control" %>
                  </div>
                  <div class="form-group">
                    <%= label_tag :no, "代號" %>
                    <%= text_field_tag :no, service.no , class: "form-control" %>
                  </div>
                  <div class="form-group">
                    <%= label_tag :name, "Name" %>
                    <%= text_field_tag :name, service.name, class: "form-control" %>
                  </div>
                  <div class="form-group">
                    <%= label_tag :lng, "經度" %>
                    <%= text_field_tag :lng, service.lng, class: "form-control" %>
                  </div>
                  <div class="form-group">
                    <%= label_tag :lat, "緯度" %>
                    <%= text_field_tag :lat, service.lat, class: "form-control" %>
                  </div>
                  <%= submit_tag "更新", class: "btn btn-primary" %>
                <% end -%>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </tbody>
  </table>
  <div class="m-auto">
    <%= paginate @services %>
  </div>
  <div class="modal fade" id="newModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">新增服務網</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <%= form_for [:admin, @service] do |f| %>
            <div class="form-group">
              <%= f.label :tag, "註記" %>
              <%= f.select :tag, ['優','無','劣'], class: "form-control" %>
            </div>
            <div class="form-group">
              <%= f.label :no, "代號" %>
              <%= f.text_field :no, class: "form-control" %>
            </div>
            <div class="form-group">
              <%= f.label :name, "Name" %>
              <%= f.text_field :name, class: "form-control" %>
            </div>
            <div class="form-group">
              <%= f.label :lng, "經度" %>
              <%= f.text_field :lng, class: "form-control" %>
            </div>
            <div class="form-group">
              <%= f.label :lat, "緯度" %>
              <%= f.text_field :lat, class: "form-control" %>
            </div>
            <%= f.submit "新增", :disable_with => 'Submiting...', class: "btn btn-primary" %>
          <% end %>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">搜尋</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
        <%= search_form_for [:admin, @ransack], { class: "form" } do |f| %>
          <div class="form-group">
            <%= f.label :name_cont, "搜尋名稱包含" %>
            <%= f.search_field :name_cont, class: "form-control" %>
          </div>
          <div class="form-group">
            <%= f.label :no_cont, "搜尋代號包含" %>
            <%= f.search_field :no_cont, class: "form-control" %>
          </div>
          <div class="form-group">
            <%= f.submit class: "btn btn-primary" %>
          </div>
        <% end %>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>

